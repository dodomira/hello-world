//테이블 만들어서 csv 파일 로드하기

CREATE TABLE bi_sandbox.mjang_ps3
(
account_id INT,
bad_date DATE,
ban_type varchar(255),
ML_tag INT,
duration INT
);

copy  bi_sandbox.mjang_ps3 from local 
'C:\Users\mjang\Desktop\Business analytics\projects\ps 문의자 분석\banlist.csv' delimiter E',' enclosed by '"';

//결과 파일로 내보내기

@export on;
@export set filename="C:\Users/\mjang\Documents\sample3.txt" delimiter E',' enclosed by ',"' ;
select * from 테이블  limit 13


 hive -e "select * from 테이블 where dt = '2016-01-01' limit 1;">outttt.tsv


//시간 변환


 SELECT 
    punishment_type, punishment_reason, game_id, account_id ,origin_system, games_punished
    , date_format(from_unixtime(created_millis/1000), '%Y-%m-%d') as start_date
    , date_format(from_unixtime(expiration_millis/1000), '%Y-%m-%d') as end_date

FROM
    punishment_record where shard_id = 'KR' 
	AND date_format(from_unixtime(created_millis/1000), '%Y-%m-%d') >= '2016-01-01'

LIMIT 1000;



///최소 최대 기준으로 다른 커럶 값 추출
select store_account_id, max(transaction_datetime), max(last_rp) from 
(select store_account_id, transaction_datetime, rp_balance, last_value(rp_balance) over(partition by store_account_id order by transaction_datetime range between unbounded preceding and unbounded following) last_rp
from staging.store_transactions where realm_id=4 and store_account_id in (8262768, 3299238)) A group by store_account_id



